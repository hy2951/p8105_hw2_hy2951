P8105 Homework 2 — hy2951
================
Haochen Yu

``` r
knitr::opts_chunk$set(echo=TRUE, message=FALSE, warning=FALSE, fig.path="figs/")

dir.create("data", showWarnings = FALSE)
dir.create("figs", showWarnings = FALSE)
list.files("data")
```

    ## character(0)

``` r
#libraries
library(tidyverse)
library(lubridate)
#pols-clean
pols <- read_csv("pols-month.csv", show_col_types = FALSE) |>
  separate(mon, into = c("year","month","day"), sep = "-", convert = TRUE) |>
  mutate(
    month = month(month, label = TRUE, abbr = FALSE),
    president = if_else(prez_gop == 1, "gop", "dem")
  ) |>
  select(year, month, president, everything(), -day, -prez_gop, -prez_dem) |>
  arrange(year, month)
#snp-clean
snp <- read_csv("snp.csv", show_col_types = FALSE) |>
  separate(date, into = c("m","d","y"), sep = "/", convert = TRUE) |>
  mutate(
    y = if_else(y < 50, 2000 + y, if_else(y < 100, 1900 + y, y)),
    month = month(m, label = TRUE, abbr = FALSE),
    year  = y
  ) |>
  transmute(year, month, close) |>
  arrange(year, month)
# unemp-tidy
unemployment <- read_csv("unemployment.csv", show_col_types = FALSE) |>
  pivot_longer(-Year, names_to = "mon", values_to = "unemployment_rate") |>
  mutate(
    mon   = str_sub(mon, 1, 3),
    mnum  = match(tolower(mon), tolower(month.abb)),
    month = month(mnum, label = TRUE, abbr = FALSE),
    year  = Year
  ) |>
  transmute(year, month, unemployment_rate) |>
  arrange(year, month)
#merge
pols_snp <- pols |> left_join(snp, by = c("year","month"))
p1_final <- pols_snp |> left_join(unemployment, by = c("year","month"))

dim_p1   <- dim(p1_final)
yr_min   <- min(p1_final$year, na.rm = TRUE)
yr_max   <- max(p1_final$year, na.rm = TRUE)

head(p1_final, 3)
```

    ## # A tibble: 3 × 11
    ##    year month    president gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem close
    ##   <dbl> <ord>    <chr>       <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <dbl>
    ## 1  1947 January  dem            23      51     253      23      45     198    NA
    ## 2  1947 February dem            23      51     253      23      45     198    NA
    ## 3  1947 March    dem            23      51     253      23      45     198    NA
    ## # ℹ 1 more variable: unemployment_rate <dbl>

In this problem, I cleaned and merged three monthly datasets from
FiveThirtyEight:pols-month.csv（counts of national politicians by party,
and the party of the sitting president (gop/dem).）snp.csv（S&P stock
index closing values.）unemployment.csv（monthly U.S. unemployment
rates.） After cleaning, I merged them by year and month. The final
dataset has 822 rows and 11columns, covering years from 1947 to 2015.
Key variables include the party of the president, counts of
governors/senators/representatives, S&P closing values, and unemployment
rates.
